<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>게시판 리스트</title>
<link rel="stylesheet" href="/css/header.css" />
<link rel="stylesheet" href="/css/reviewList.css">
<link rel="stylesheet" href="/css/default.css">
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
	integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
	crossorigin="anonymous" referrerpolicy="no-referrer" />
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="/js/index.js"></script>

<script>

/* let createTime = [[${reviews}]];
console.log(createTime);
function timeForToday() {
    const displayCreatedAt = (createdAt) => {
      let startTime = new Date(createdAt);
      let nowTime = Date.now();
      let timeDiff = nowTime - startTime;
      let result = "";

      if (timeDiff < 60000) {
        result = "방금 전";
      } else if (timeDiff < 3600000) {
        result = `${Math.floor(timeDiff / 60000)} 분 전`;
      } else if (timeDiff < 86400000) {
        result = `${Math.floor(timeDiff / 3600000)} 시간 전`;
      } else {
        result = startTime.toLocaleDateString();
      }

      return `<td>${result}</td>`;
    };

    // 특정 날짜 값 (createdAt)을 전달하여 결과 얻기
    let result = displayCreatedAt(createTime);
	  //console.log(result);
    return result;
  }
 */
      function search() {
        let searchText = document.getElementById("searchText").value;
        location.href="/review/list?searchText=" + searchText;
      }
 
 function translate(lang) {
	    // 번역할 코드

			  let text = document.getElementById("review").innerHTML;
			  // ajax 호출 등의 코드 추가
			   $.ajax({
			      url: "/translate",
			      type: "post",
			      data:{
			    	  text : text,
			    	  lang:lang,
			      },
			      success: function (data, success, xhr) {
			    	    const name = data.name;
			    	    const resultHTML = `
			    	        <h1 id="review">
			    	            ${name}
			    	        </h1>
			    	    `;
			    	    document.body.innerHTML = resultHTML;
			    	},
			      error: function (xhr, status, error) {
			        console.log(status);
			      }
			    });
		}
 
 $(document).ready(function(){
	    $("#translate-en").click(function(){
	        translate('en');
	    });
	    $("#translateja").click(function(){
	        translate('ja');
	    });
	    $("#translatezh-CN").click(function(){
	        translate('zh-CN');
	    });
	});
    </script>
</head>
<body>

	<div th:replace="fragments/header :: header"></div>
	<div class="header-container">
	
	
	<button id="translate-en"> 번역하기</button>
	
	
		<div class="review" id="review">

			<section class="notice">
				<div class="page-title">
					<h1>[ 명소 & 상세 리스트]</h1>
				</div>
				
					<div class="review-container">
					<!-- board seach area -->
					<div id="review-search">
						<div class="search-window">
								<div class="search-wrap">
									<input id="searchText" type="search" name="searchText"
										placeholder="검색어를 입력해주세요.">
									<button type="button" onclick="search()" class="btn search-btn">검색</button>
								</div>
						</div>
					</div>
				
				
				<p>
				<table class="review-table">
					<thead>
							<tr class="mainTitle">
								<th scope="col" class="th-num">No</th>
								<th scope="col" class="th-place">Place</th>
								<th scope="col" class="th-title">Title</th>
								<th scope="col" class="th-writer">Writer</th>
								<th scope="col" class="th-date">Date</th>
								<th scope="col" class="th-hit">HIT</th>
							</tr>
					</thead>
					<tbody th:if="${session.loginMember != null}">
							<tr th:if="${findReviewsByMainTitle}" th:each="review, reviewsStat: ${findReviewsByMainTitle}">
								<td class="color" th:text="${reviewsStat.count}"></td>
								<td class="color" th:text="${review.review_place}"></td>
								<th><a th:text="${review.title}"
									th:href="@{/review/read(review_id=${review.review_id})}"></a></th>
								<td th:text="${review.member_id}" class="center"></td>
								<!-- <td id="myTd"></td>
								<script>
     							 // 결과를 span에 표시하는 함수 실행
     								 document.getElementById("myTd").innerHTML = timeForToday();
    							</script> -->
								<td th:text="${#temporals.format(review.created_time, 'yyyy-MM-dd')}"></td>
								<td th:text="${review.hit}"></td>
							</tr>
							<tr th:if="${findReviewsByMainTitle.empty}">
							    <td class="color" colspan="6">리뷰가 없습니다.</td>
							</tr>
					</tbody>
				</table>
				<p>
				<p>
				<div class="center">
					<input type="button" onclick="location.href='/review/list'"
						value="목록으로" class="input-btn"> 
					<input th:unless="${#list.contains(reviews,member_id)}" href="javascript:;" type="button" class="input-btn"
						onclick="location.href='/review/write'" value="글쓰기"> 
					<input class="input-btn"
						type="button" onclick="location.href='/'" value="메인으로">
				</div>
				</div>
			</section>
			
			
			
		</div>
		
		
		
		
		
		
		
		
		
		
		
		
</div>
</body>
</html>